<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Race</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <link rel="stylesheet" type="text/css" href="css/form.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  <script src="js/main.js"></script>
  <script>
    $(document).ready(function () {
        let socket = io();
        let score = {
          0: 0,
          1: 0,
          2: 0,
          3: 0
        };

        for (let i = 0; i < 4; i++) {
          $('#field').append(`<div class='player${i}'></div>`);
          $('#btns').append(`<button id="btn${i}" class="btn btn-primary">Go</button>`)
        }

        socket.on('scores', data => {
          score[data['player']] = data['score'];
          if (score[data['player']] == -280) {
            $('#main').html(`<h1>Player ${data['player']} wins!!!</h1><img src='https://media.giphy.com/media/lMameLIF8voLu8HxWV/giphy.gif'>`)
          }
          $(`.player${data['player']}`).css({top: `${data['score']}px`});
        });

        $('#btns').on('click', '#btn1', () => {
          $('.player1').css({top: '-10px'});
        })


        for (let i = 0; i < 4; i++) {
          $('#btns').on('click', `#btn${i}`, () => {
            score[i] -= 5;
            if (score[i] == -280) {
              $('#main').html(`<h1>Player ${i} wins!!!</h1><img src='https://media.giphy.com/media/lMameLIF8voLu8HxWV/giphy.gif'>`);
            }
            $(`.player${i}`).css({top: `${score[i]}px`});
            socket.emit('update', {score: score[i], player: i});
          });
        }
      });
  </script>
</head>
<body>
  <div id="start">
    <form id="startF">
      <div class="form-group">
        <label for="players">How many players?</label>
        <input class='form-control' type="number" name="players" id="playerForm">
      </div>
      <button class="btn btn-primary">Go</button>
    </form>
  </div>
  <div id="main">
    <h1>Socket Race</h1>
    <div id="field">

    </div>
    <div id="btns">
    
    </div>
  </div>
</body>
</html>